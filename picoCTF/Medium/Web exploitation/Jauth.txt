Author: Tony_29
Category: Web Exploitation 
Challenge: JAuth
Difficulty: Medium 

Description

Most web application developers use third party components without testing their security. Some of the past affected companies are:

    Equifax (a US credit bureau organization) - breach due to unpatched Apache Struts web framework CVE-2017-5638
    Mossack Fonesca (Panama Papers law firm) breach - unpatched version of Drupal CMS used
    VerticalScope (internet media company) - outdated version of vBulletin forum software used

Can you identify the components and exploit the vulnerable one? The website is running here. Can you become an admin? You can login as test with the password Test123! to get started.


Objective :

Login as normal user and escalate to admin privilege by mainipulating the jwt token and get the flag

Walkthrough :

Step 1 — Initial Analysis

 Logged into the website from the given link and credentials
 Found nothing in the website comments and found that jwt token is using as cookie

Step 2 — Investigation / Enumeration
 Copied the jwt token and decoded it using jwt.io
 Found that the signature verification process is failing ,so the server don't verifies the signature of the jwt token 

Step 3 — Exploitation / Decoding / Solving

 Modified the json body of the jwt token and crafted a jwt token with role as admin and algorithm none 
 None algorithm creates a unsigned jwt token which can be supplied when the server signature verification fails and it gives option for privilege modification
    {
      "typ": "JWT",
      "alg": "none"
    }

  Crafted payload :
    {
      "auth": 1763342842858,
      "agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:144.0) Gecko/20100101 Firefox/144.0",
      "role": "admin",
      "iat": 1763342843
    }   

Step 4 — Retrieve the Flag

 injected the final crafted jwt token payload into the cookies 
 The flag was shown as response  

Flag :
picoCTF{succ3ss_@u7h3nt1c@710n_bc6d9041}

